2장 스위치

스위치 부팅과정

1. POST실행
2. 낮은수준의 CPU초기화
3. 플래시 파일 시스템을 초기화
4. 플래시의 IOS이미지를 찾아와 RAM에 설치한다.
5. NVRAM의 설정파일을 불러온다.

시스템 충돌복구

1. 스위치에 콘솔케이블로 PC를연결한다( IOS에는 입출력 장치를 제공하지않음)
2. 스위치의 전원코드를 뽑는다.
3. 스위치에 전원코드를 다시 연결하고 15초 이내에 시스템 LED가 녹색으로 반짝이는 
동안 모드유지하다가 뗀다
4. 시스템LED가 황색과 녹색으로 될 때까지 잠시 버튼을 누른채로 유지하다가 땐다.
5. 부트로더 스위치 프롬프트가 PC의 터미널에 에뮬려이션 소프트웨어에 나타난다.

* 부트로더 명령라인은 플래시 파일시스템의 구조명령, 운용체제소프트웨어 재설치,
비밀번호 복구를 지원한다.

스위치 LED표시

system led : 시스템전원
rps : 무정전공급기
status : 각포트의상태
duplex : 각포트의 듀플랙스모드
speed : 각포트의 색깔로 속도를 나타냄
poe : 데이터만 보내지않고, 전원까지 같이 보낸다.

통신방법 
Duplex 송수신이 가능한것
simplex 수신이나, 송신만 가능한것
fullduplex 송수신이 동시에 가능한것
halfduplex 송신 수신이 가능하지만, 동시에 불가능하다.


auto-MDIX
장치를 연결하는 경우, 케이블의 특정한유형(스트레이트 스루, 크로스오버)가 필요했다.
하지만 auti-MDIX 기능을 사용하여 이문제를 해결한다.

전기선호를 소프트웨어적으로 바꾸어, 스트레이트 케이블로도, 크로스 케이블연결한
 효과를 낼수 있다.

텔넷과 ssh
텔넷은 모든 데이터들이 평문으로 전송되지만,
ssh는 모든 데이터들이 암호문으로 전송되어 보안에 강력하다.
23번 : telnet
22번 : ssh

맥어드레스 풀공격
스위치는 프레임을 통해 학습된 포트와,mac주소를 테이블에 
기록한다.
기록된 정보를 바탕으로 테이블을 만들고, 이 테이블에따라서
프레임을 포워딩해준다. 하지만 이 테이블의 크기는 제한되어있고.
공격자가 이를 이용하여 가짜 mac주소를 계속보내어 테이블이 가득
차게되면 스위치는 마치 허브처럼 작동하게되어 모든 포트로 플러딩하게되
된다. 이때에 공격자는 모든 프레임 정보를 볼 수 있다.

dhcp starvation attack
공격자가 mac주소를 게속 바꾸어서 dhcp서버가 할당할 수 있는
ip주소를 모두 다받아내버린다. 

dhcp spoofing attack
PC가 커지면 브로드캐스트를 통해서 DHCP 서버를 찾는다.
DHCP 서버가 PC로 IP주소를 할당해준다.
해커의 가짜 DHCP가 먼저 응답을 한다.
IP 주소와 DNS를 정상적으로 주고, 디폴트게이트웨이를 가짜로준다.
즉 모든 바깥으로 가능 통신패킷을 자기가 받고 , 그것을 다시원래의 디폴트 게이트웨이로보낸다.
솔루션
스위치에서, 하나의 포트에서만 응답을 (원래의 서버만 응답이 가능하도록 설정)
할 수 있게 해주어 이러한 해커의 공격을 막을 수 있다.

CDP : 직접연결된 cisco장비를 검색할때 사용하는 2계층 시스코 전용 프로토콜이다.
ip주소, 소프트웨어버전, 플랫폼, 장비성능, 네이티브 vlan등장치에 관한정보를 제공한다.
* 사용하지 않는 장치나 포트에는 cdp를 비활성화 한다.
no cdp run

brute force 공격
사전을 이용하여 가능한 문자조합을 모두 대입하여 암호를 맞추려는 무차별 대입공격이다.
* 막는방법은 acl을통해 반복 횟수제한을 두면된다.

텔넷 dos 공격
사용하려는 포트를 계속 공격한다.

ntp: 네트워크상에서 네트워크 장비들의 시간을 동기화 시켜주는 프로토콜이다.
- 네트워크 장치는 ntp서버또는 ntp 클라이언트 중 하나로 구성될 수 있다.
R1(config)# ntp master 1 //ntp 서버로 동작 
R2(config)# ntp server 10.1.1.1 // ntp클라이언트로 서버에서 시간을받아와 동기화 한다.

스위치의 포트보안
사용하지 않는 포트는 모두 shutdown
switch port-security 를 통해서 포트보안설정

violation을 이용해서 포트 위반시 정책설정
shutdown : 해당포트 차단
protect : 해당 맥 차단
restrict : protect처럼 작동하고 로그메시지를 알려준다.
