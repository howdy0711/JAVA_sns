5장

inter-vlan

스위치의 vlan을 통해서 네트워크를 분할하게되면, 서로가 다른 네트워크가 되기때문에
통신을 하기위해서는 3계층이상의 장비 (ip를 식별할 수 있는)가 필요하다.

nter-VLAN이란?
vlan간에 통신을 말한다.
앞서 설명한 바와 같이 vlan도 하나의 LAN이기 때문에 통신을 하기 위해선 3계층 장비가
필요하다.
3가지 방식이 있다.

1. Legacy Inter-VLAN
말그대로 옛날 방식을 말한다. VLAN도 LAN이기 때문에 각각 해당되는 네트워크 대역이
있다. 라우터에 각각 해당되는 네트워크 대역의 물리 인터페이스만큼 설정해주어서 통신해주는
방식을 말한다.

2. Router-on-a-Stick
레거시방법을 보완한 방식이다. 레거시의 경우 vlan 갯수만큼 물리 인터페이스를 
할당해주어야 하였다. 100개면 100개, 10개면 10개. 비용뿐만아니라 엄청 비효율적이다.
따라서, 하나의 물리 인터페이스에서 여러 서브인터페이스를 나눠서 사용하는 방식이다.
즉, vlan이 10개면 하나의 물리인터페이스에서 10개의 서브인터페이스로 나눠서
각각의 알맞은 네트워크 대역을 할당해서 통신하는 방식이다.
참고로 서브인터페이스 번호는 vlan번호와 맞춰주는 것이 관례다.

3. SVI를 이용한 Inter-VLAN
3계층 스위치에서 사용하는 방식이다. 3계층 스위치의 경우 각각의 포트를 2계층 포트가
아닌 3계층 포트로 동작이 가능하다. 하지만, 해당 인터페이스는 IP의 개념은 사용가능하나
서브인터페이스 사용이 불가능하다.(Routed Port라고 한다. 라우티드 포트는 라우터
물리 인터페이스와 비슷하나, 서브 인터페이스 지원이 되지 않는다.) 따라서, 다른 방식을
이용하여서 Inter-VLAN을 하게 된다.
이에 사용되는 방식이 SVI(Switch Virtual Interface)를 이용한 방식이다.
SVI는 특정 VLAN을 대표하는 3계층 가상 인터페이스이다.
3계층이기 때문에 IP 설정이 가능하며, 가상 인터페이스이기 때문에 vlan 갯수만큼
생성가능하다. 그리고 해당 VLAN을 대표하는 3계층 가상 인터페이스이기 때문에
특정 VLAN에 대해서 각각 하나씩 생성이 가능하다.

	
명령어정리

레거시방법
물리적 인터페이스 마다 직접적으로 ip 부여  
각 포트마다 ip 부여 
스위치는 각포트마다 vlan부여 
int f0/0
config-if)# ip주소

라우터 온어 스틱
하나의 인터페이스를 서브인터페이스로 쪼개서 서브인터페이스 마다 ip 부여 
int f 0/0.1
config-if)# encapsulration dot1q {vlan 번호}
config-if)# ip주소 

svi 설정
l3 스위치를 이용하여 가상 vlan포트를 만들어 ip 부여
int f0/0
config-if) switchport trunk encapsulation dot1q
config-if) switchport mode trunk
int vlan {번호}
config-if) ip 부여
